<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ton Brainlag</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #0a0a0a;
      color: #f0f0f0;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
  max-width: 680px;
  margin: 0 auto;
  padding: 80px 20px 40px 20px; /* augmente l'espace en haut */

}
    h1 { font-size: 1.8rem; text-align: center; margin-bottom: 10px; letter-spacing: 1px; }
    .subtitle {
      text-align: center;
      color: #888;
      margin-bottom: 40px;
      font-size: 0.95rem;
      line-height: 1.6;
    }
    .question-block { margin-bottom: 36px; }
    .question-number { color: #666; font-size: 0.8rem; margin-bottom: 6px; }
    .question-text {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 14px;
      color: #e0e0e0;
      padding-bottom: 8px;
      border-bottom: 1px solid #222;
    }
    .options { display: flex; flex-direction: column; gap: 8px; }
    .option-btn {
      background: #111;
      border: 1px solid #2a2a2a;
      color: #ccc;
      padding: 12px 16px;
      border-radius: 10px;
      cursor: pointer;
      text-align: left;
      font-size: 0.92rem;
      transition: all 0.2s;
    }
    .option-btn:hover { border-color: #555; color: #fff; background: #1a1a1a; }
    .option-btn.selected { border-color: #7c6af7; color: #fff; background: #1a1a2e; }
  .progress-bar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 10px;              /* plus Ã©pais */
  background: #1f1f1f;
  z-index: 9999;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #3b82f6, #22d3ee);
  box-shadow: 0 0 12px rgba(34,211,238,0.6);
  transition: width 0.4s ease;
}
    .submit-btn {
      display: block;
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #7c6af7, #c084fc);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 30px;
      transition: opacity 0.2s;
    }
    .submit-btn:hover { opacity: 0.85; }
    .submit-btn:disabled { opacity: 0.3; cursor: not-allowed; }
    .error-msg {
      color: #f87171;
      font-size: 0.85rem;
      text-align: center;
      margin-top: 12px;
      display: none;
    }

    /* â”€â”€ RÃ‰SULTATS â”€â”€ */
    .divider { border: none; border-top: 1px solid #2a2a2a; margin: 28px 0; }
    .tag {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
      margin-bottom: 12px;
    }
    .tag-dominant { background: #1a1530; color: #c084fc; border: 1px solid #7c6af7; }
    .tag-secondary { background: #0f1f1a; color: #6ee7b7; border: 1px solid #34d399; }
    .tag-mix { background: #1a1200; color: #fbbf24; border: 1px solid #f59e0b; }

    .profile-card {
      background: #111;
      border: 1px solid #2a2a2a;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 20px;
    }
    .profile-header { display: flex; align-items: center; gap: 20px; margin-bottom: 20px; }
    .profile-avatar {
      width: 90px;
      height: 90px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #2a2a2a;
      flex-shrink: 0;
    }
    .profile-title { font-size: 1.6rem; font-weight: 800; margin-bottom: 4px; }
    .profile-subtitle { color: #888; font-size: 0.9rem; }

    .section-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: #666;
      margin-bottom: 8px;
      margin-top: 16px;
    }
    .section-content { color: #ddd; line-height: 1.7; font-size: 0.95rem; }

    .steps { list-style: none; padding: 0; }
    .steps li {
      padding: 10px 0 10px 28px;
      position: relative;
      color: #ccc;
      font-size: 0.92rem;
      line-height: 1.5;
      border-bottom: 1px solid #1a1a1a;
    }
    .steps li::before { content: "â†’"; position: absolute; left: 0; color: #7c6af7; }

    .mix-card {
      background: #111;
      border: 1px solid #2a2a2a;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .score-bar-wrap { margin-bottom: 12px; }
    .score-bar-label {
      display: flex;
      justify-content: space-between;
      font-size: 0.82rem;
      color: #888;
      margin-bottom: 4px;
    }
    .score-bar { height: 6px; background: #1a1a1a; border-radius: 3px; }
    .score-bar-fill { height: 100%; border-radius: 3px; transition: width 0.6s ease; }

    /* â”€â”€ ACTION BUTTONS â”€â”€ */
    .action-buttons { display: flex; flex-direction: column; gap: 12px; margin-top: 8px; }
    .btn-action {
      display: block;
      width: 100%;
      padding: 14px 20px;
      border-radius: 12px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      text-align: center;
      text-decoration: none;
      transition: all 0.2s;
      border: none;
    }
    .btn-share { background: linear-gradient(135deg, #7c6af7, #c084fc); color: white; }
    .btn-share:hover { opacity: 0.85; }
    .btn-instagram { background: transparent; border: 1px solid #c084fc !important; color: #c084fc; }
    .btn-instagram:hover { background: #1a1530; }
    .btn-restart { background: #1a1a1a; border: 1px solid #333 !important; color: #888; }
    .btn-restart:hover { background: #222; color: #aaa; }

    /* â”€â”€ END SCREEN â”€â”€ */
    #endScreen { display: none; text-align: center; padding: 60px 24px; }
    .end-klea-msg {
      background: linear-gradient(135deg, #1a1530, #0f1a1f);
      border: 1px solid #2a2a3a;
      border-radius: 20px;
      padding: 36px 28px;
      margin-bottom: 32px;
      position: relative;
      overflow: hidden;
    }
    .end-klea-msg::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 2px;
      background: linear-gradient(90deg, #7c6af7, #c084fc, #34d399);
    }
    .end-label { font-size: 11px; letter-spacing: 3px; color: #555; text-transform: uppercase; margin-bottom: 20px; }
    .end-title { font-size: 1.4rem; font-weight: 300; color: #e0e0e0; line-height: 1.7; margin-bottom: 16px; }
    .end-title strong {
      background: linear-gradient(135deg, #c084fc, #7c6af7);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 700;
    }
    .end-subtitle { font-size: 1rem; color: #666; font-style: italic; line-height: 1.6; margin-bottom: 24px; }
    .end-signature { font-size: 0.85rem; color: #7c6af7; letter-spacing: 1px; }
    .end-actions { display: flex; flex-direction: column; gap: 12px; }
    .end-btn {
      display: block;
      width: 100%;
      padding: 14px 20px;
      border-radius: 12px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      text-align: center;
      text-decoration: none;
      transition: all 0.2s;
      border: none;
    }
    .end-btn-primary { background: linear-gradient(135deg, #7c6af7, #c084fc); color: white; }
    .end-btn-primary:hover { opacity: 0.85; }
    .end-btn-instagram { background: transparent; border: 1px solid #c084fc !important; color: #c084fc; }
    .end-btn-instagram:hover { background: #1a1530; }
    .end-btn-restart { background: #111; border: 1px solid #2a2a2a !important; color: #666; }
    .end-btn-restart:hover { background: #1a1a1a; color: #888; }
  </style>
</head>

<body>
  <div class="container">

    <!-- â”€â”€ QUIZ SECTION â”€â”€ -->
    <div id="quizSection">
      <h1>Ton Brainlag</h1>
      <p class="subtitle">
        Ce quiz nâ€™est pas un diagnostic.<br>
        Câ€™est un miroir.<br>
        RÃ©ponds spontanÃ©ment, sans chercher la â€œbonneâ€ rÃ©ponse.
      </p>

      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>

      <div id="questionsContainer"></div>

      <button class="submit-btn" id="submitBtn" onclick="showResults()" disabled>
        Voir mon rÃ©sultat â†’
      </button>
      <p class="error-msg" id="errorMsg">RÃ©ponds Ã  toutes les questions pour continuer.</p>
    </div>

    <!-- â”€â”€ RESULT SECTION â”€â”€ -->
    <div id="resultSection" style="display:none"></div>

    <!-- â”€â”€ END SCREEN â”€â”€ -->
    <div id="endScreen">

      <div class="end-klea-msg">
        <p class="end-label">â€” Klea â€”</p>

        <p class="end-title">
          Merci d'avoir pris<br>
          ce moment <strong>pour toi.</strong>
        </p>

        <p class="end-subtitle">
          Ce n'est pas rien de se regarder en face.<br>
          Ã‡a demande du courage. ğŸ¤
        </p>

        <p class="section-content" style="color:#aaa; font-size:0.9rem; line-height:1.8; margin-bottom:20px;">
          Ce que tu viens de dÃ©couvrir n'est pas une case.<br>
          C'est une piste. Un point de dÃ©part.<br><br>
          Ton brainlag n'est pas ton identitÃ© â€”<br>
          c'est la faÃ§on dont ton systÃ¨me a appris Ã  tenir.<br><br>
          Et ce qui s'apprend peut se transformer.
        </p>

        <p class="end-signature">â€” Klea</p>
      </div>

      <div class="end-actions">
        <button class="end-btn end-btn-primary" onclick="shareQuiz()">â†— Partager le quiz</button>
        <a class="end-btn end-btn-instagram" href="https://www.instagram.com/klea.brainlag/" target="_blank">â†’ Rejoindre @klea.brainlag</a>
        <button class="end-btn end-btn-restart" onclick="restartQuiz()">â†º Recommencer le quiz</button>
      </div>

    </div>
  </div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   1) Ã‰TAT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

const answers = {};           // on stocke maintenant lâ€™objet "option" (pas juste le profile)
const TOTAL_Q = 12;

// Shuffle stable pendant la session
let shuffledQuestions = [];

// Dynamiques invisibles (7/9/2)
let shadowScores = {
  enthousiasme: 0, // 7
  harmonie: 0,     // 9
  relation: 0      // 2
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   2) OUTILS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function shuffleArray(array) {
  const arr = [...array];
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function computeShadow() {
  const sorted = Object.entries(shadowScores).sort((a,b) => b[1] - a[1]);
  const [key, val] = sorted[0];

  const labels = {
    enthousiasme: "une tendance Ã  fuir lâ€™inconfort par la stimulation (changer, relancer, accÃ©lÃ©rer)",
    harmonie: "un besoin fort de prÃ©server lâ€™harmonie (Ã©viter le conflit, lisser, sâ€™adapter)",
    relation: "une inclination Ã  te tourner vers les autres pour te sentir utile / aimÃ©(e)"
  };

  // Seuil : Ã  partir de 2 occurrences, on considÃ¨re â€œsignificatifâ€
  if (val >= 2) {
    return { key, val, text: labels[key] };
  }
  return null;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   3) QUESTIONS
   (Textes identiques. On ajoute juste "shadow" sur certaines options.)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

const questions = [
  {
    text: "Quand tu dois prendre une dÃ©cision importanteâ€¦",
    options: [
      { label: "Tu analyses tous les angles possibles avant d'agir", profile: "analyse" },
      { label: "Tu prÃ©pares plusieurs scÃ©narios pour Ãªtre prÃªt(e)", profile: "controle", shadow: "harmonie" },
      { label: "Tu te demandes ce que Ã§a va apporter Ã  ton image", profile: "performance", shadow: "enthousiasme" },
      { label: "Tu vÃ©rifies que tout est parfaitement en ordre", profile: "rigueur" },
      { label: "Tu ressens si c'est juste ou non, viscÃ©ralement", profile: "sensibilite" },
      { label: "Tu prends le lead et tu avances", profile: "puissance" }
    ]
  },
  {
    text: "Quand tu es stressÃ©(e), ton rÃ©flexe automatique c'estâ€¦",
    options: [
      { label: "RÃ©flÃ©chir encore plus pour trouver la solution", profile: "analyse" },
      { label: "Tout anticiper pour Ã©viter les surprises", profile: "controle" },
      { label: "Travailler plus pour ne pas Ãªtre en retard", profile: "performance" },
      { label: "Tout vÃ©rifier et corriger ce qui cloche", profile: "rigueur" },
      { label: "Absorber l'ambiance Ã©motionnelle autour de toi", profile: "sensibilite", shadow: "relation" },
      { label: "Prendre le contrÃ´le de la situation", profile: "puissance" }
    ]
  },
  {
    text: "Ce qui t'Ã©puise le plus en ce momentâ€¦",
    options: [
      { label: "Ne pas comprendre pourquoi les choses ne marchent pas", profile: "analyse" },
      { label: "L'impression que tout peut dÃ©raper Ã  tout moment", profile: "controle" },
      { label: "Faire beaucoup sans Ãªtre vraiment reconnu(e)", profile: "performance" },
      { label: "Les dÃ©tails qui ne sont jamais tout Ã  fait bons", profile: "rigueur" },
      { label: "Ressentir trop â€” les autres, l'atmosphÃ¨re, tout", profile: "sensibilite" },
      { label: "Devoir constamment justifier tes dÃ©cisions", profile: "puissance" }
    ]
  },
  {
    text: "Une tension monte au travail ou dans un groupe. Tuâ€¦",
    options: [
      { label: "Analyses ce qui a causÃ© la tension", profile: "analyse" },
      { label: "Surveilles tout pour Ã©viter l'escalade", profile: "controle", shadow: "harmonie" },
      { label: "Augmentes ta productivitÃ© pour montrer ta valeur", profile: "performance" },
      { label: "Corriges ce qui ne va pas avec prÃ©cision", profile: "rigueur" },
      { label: "Ressens fortement l'atmosphÃ¨re du groupe", profile: "sensibilite", shadow: "relation" },
      { label: "Prends le leadership pour calmer ou trancher", profile: "puissance" }
    ]
  },
  {
    text: "Quelqu'un te critique. Ta premiÃ¨re rÃ©actionâ€¦",
    options: [
      { label: "Tu repasses la scÃ¨ne dans ta tÃªte en boucle", profile: "analyse" },
      { label: "Tu cherches ce qui a dÃ©clenchÃ© cette rÃ©action", profile: "controle" },
      { label: "Tu veux prouver le contraire par les actes", profile: "performance" },
      { label: "Tu te reproches de ne pas avoir fait mieux", profile: "rigueur" },
      { label: "Tu le vis intensÃ©ment, Ã§a reste longtemps", profile: "sensibilite" },
      { label: "Tu rÃ©agis directement, sans filtre", profile: "puissance" }
    ]
  },
  {
    text: "Quand tu te sens dÃ©passÃ©(e)â€¦",
    options: [
      { label: "Tu entres dans le mental, tu analyses encore plus", profile: "analyse" },
      { label: "Tu tentes de tout reprendre en main", profile: "controle" },
      { label: "Tu accÃ©lÃ¨res pour rattraper le retard", profile: "performance", shadow: "enthousiasme" },
      { label: "Tu deviens plus rigide, plus exigeant(e)", profile: "rigueur" },
      { label: "Tu te sens submergÃ©(e) par les Ã©motions", profile: "sensibilite" },
      { label: "Tu durcis ta posture et tu imposes ta vision", profile: "puissance" }
    ]
  },
  {
    text: "Ce que tu fais pour te sentir en sÃ©curitÃ©â€¦",
    options: [
      { label: "Comprendre â€” tout, tout le temps", profile: "analyse" },
      { label: "Anticiper et prÃ©voir les risques", profile: "controle" },
      { label: "Prouver ta valeur par ce que tu accomplis", profile: "performance" },
      { label: "Maintenir l'ordre et la qualitÃ© autour de toi", profile: "rigueur" },
      { label: "Rester connectÃ©(e) Ã  ce que tu ressens vraiment", profile: "sensibilite", shadow: "relation" },
      { label: "Garder le contrÃ´le de ce qui t'entoure", profile: "puissance" }
    ]
  },
  {
    text: "Ce que les autres remarquent souvent chez toiâ€¦",
    options: [
      { label: "Ta capacitÃ© Ã  analyser des situations complexes", profile: "analyse" },
      { label: "Ton souci du dÃ©tail et ton anticipation", profile: "controle" },
      { label: "Ton Ã©nergie et ta capacitÃ© Ã  produire", profile: "performance" },
      { label: "Ton exigence envers toi-mÃªme et les autres", profile: "rigueur" },
      { label: "Ta sensibilitÃ© et ta profondeur Ã©motionnelle", profile: "sensibilite" },
      { label: "Ton assurance et ton impact naturel", profile: "puissance" }
    ]
  },
  {
    text: "Ce dont tu aurais besoin en ce moment mais que tu n'arrives pas Ã  t'offrirâ€¦",
    options: [
      { label: "Du calme mental â€” arrÃªter de tout analyser", profile: "analyse" },
      { label: "LÃ¢cher prise sur ce que tu ne contrÃ´les pas", profile: "controle", shadow: "harmonie" },
      { label: "Exister sans avoir Ã  tout le temps prouver", profile: "performance" },
      { label: "Accepter l'imperfection sans te punir", profile: "rigueur" },
      { label: "Moins absorber les Ã©motions des autres", profile: "sensibilite" },
      { label: "Montrer une limite sans perdre ta force", profile: "puissance" }
    ]
  },
  {
    text: "La phrase qui te ressemble le plus en ce momentâ€¦",
    options: [
      { label: "\"Si je comprends tout, rien ne peut me surprendre.\"", profile: "analyse" },
      { label: "\"Si j'anticipe tout, rien ne peut mal tourner.\"", profile: "controle" },
      { label: "\"Si je fais assez, je mÃ©rite ma place.\"", profile: "performance" },
      { label: "\"Si c'est parfait, je suis en sÃ©curitÃ©.\"", profile: "rigueur" },
      { label: "\"Si je ressens tout, je ne rate rien d'important.\"", profile: "sensibilite", shadow: "relation" },
      { label: "\"Si je garde le contrÃ´le, tout ira bien.\"", profile: "puissance" }
    ]
  },
  {
    text: "Quand quelque chose dâ€™imprÃ©vu arriveâ€¦",
    options: [
      { label: "Tu analyses rapidement pour comprendre ce qui se passe", profile: "analyse" },
      { label: "Tu anticipes les consÃ©quences possibles", profile: "controle" },
      { label: "Tu agis vite pour reprendre la main", profile: "performance", shadow: "enthousiasme" },
      { label: "Tu cherches la bonne maniÃ¨re de faire", profile: "rigueur" },
      { label: "Tu ressens lâ€™impact Ã©motionnel avant tout", profile: "sensibilite" },
      { label: "Tu prends le lead pour gÃ©rer la situation", profile: "puissance" }
    ]
  },
  {
    text: "Quand tu penses Ã  lâ€™avenir procheâ€¦",
    options: [
      { label: "Tu veux comprendre oÃ¹ tu vas vraiment", profile: "analyse" },
      { label: "Tu cherches Ã  sÃ©curiser ce qui pourrait mal tourner", profile: "controle" },
      { label: "Tu te demandes ce que tu vas accomplir", profile: "performance", shadow: "enthousiasme" },
      { label: "Tu veux que tout soit clair et structurÃ©", profile: "rigueur" },
      { label: "Tu Ã©coutes ce que tu ressens intÃ©rieurement", profile: "sensibilite" },
      { label: "Tu veux dÃ©cider et avancer", profile: "puissance" }
    ]
  }
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   4) PROFILS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

const profiles = {
  analyse: {
    name: "Eliot",
    mode: "L'observateur",
    emoji: "ğŸ”µ",
    color: "#6366f1",
    img: "images/Eliot.png",
    brainlag: "Ton cerveau tourne en boucle. Il analyse, dÃ©cortique, cherche la logique â€” mÃªme quand il n'y en a pas. C'est ton systÃ¨me de protection : comprendre pour ne pas Ãªtre surpris.",
    hypothese: "\"Si je comprends tout, rien ne peut me blesser ou me dÃ©passer.\"",
    protection: "Tu prends de la distance. Tu observes avant d'agir. Tu collectes des informations pour te sentir en sÃ©curitÃ© dans ta propre tÃªte.",
    glitch: "Tu dÃ©penses une Ã©nergie Ã©norme Ã  penser. Et pendant ce temps, tu n'agis pas. Tu restes dans le mental pour Ã©viter le contact avec ce qui pourrait te submerger.",
    reboot: [
      "Pose-toi cette question : 'Est-ce que j'ai besoin de comprendre davantage, ou est-ce que j'ai dÃ©jÃ  assez d'infos pour agir ?'",
      "Fixe-toi une limite mentale : 10 minutes d'analyse max, puis une action concrÃ¨te â€” mÃªme petite.",
      "Remarque quand tu utilises 'j'analyse' pour Ã©viter de ressentir quelque chose d'inconfortable.",
      "Pratique une chose par semaine qui ne se comprend pas â€” qui se vit juste.",
      "Offre ton analyse Ã  quelqu'un : partager ce que tu penses sort la connaissance de ta tÃªte et la met en mouvement."
    ]
  },
  controle: {
    name: "Jiwooh",
    mode: "L'architecte de sÃ©curitÃ©",
    emoji: "âšª",
    color: "#94a3b8",
    img: "images/Jiwooh.png",
    brainlag: "Ton systÃ¨me surveille en permanence. Il anticipe les risques, vÃ©rifie les dÃ©tails, construit des plans B pour les plans B. C'est ton armure : si tout est prÃ©vu, rien ne peut te surprendre.",
    hypothese: "\"Si j'anticipe tout, je peux Ã©viter que quelque chose de grave arrive.\"",
    protection: "Tu planifies, tu vÃ©rifies, tu organises. Tu es celui ou celle sur qui on peut compter â€” parce que tu n'as pas le droit de rater.",
    glitch: "Le contrÃ´le est Ã©puisant. Et il ne protÃ¨ge pas vraiment â€” il repousse juste l'anxiÃ©tÃ©. Plus tu contrÃ´les, plus tu as peur de perdre le contrÃ´le.",
    reboot: [
      "Identifie une chose aujourd'hui que tu pourrais laisser aller sans catastrophe.",
      "Demande-toi : 'Est-ce que je planifie parce que c'est nÃ©cessaire, ou parce que Ã§a me rassure ?'",
      "Pratique de dÃ©lÃ©guer une tÃ¢che â€” mÃªme petite â€” sans vÃ©rifier le rÃ©sultat.",
      "Remarque ce que tu ressens quand tu n'as pas le contrÃ´le. Reste avec Ã§a 2 minutes.",
      "Dis Ã  quelqu'un de confiance une chose dans laquelle tu n'es pas sÃ»r(e) de toi."
    ]
  },
  performance: {
    name: "Luna",
    mode: "Le moteur en feu",
    emoji: "ğŸŸ¡",
    color: "#f59e0b",
    img: "images/Luna.png",
    brainlag: "Tu avances, tu produis, tu accomplis. Ton moteur tourne fort. Mais quelque part, tu cours aprÃ¨s quelque chose que tu n'arrives pas Ã  attraper : la preuve que tu es assez.",
    hypothese: "\"Si je fais assez, j'aurai enfin ma place.\"",
    protection: "Tu te valorises Ã  travers ce que tu produis. Tu deviens indispensable. Tu montres ce que tu vaux â€” parce que sans Ã§a, tu ne sais pas trop ce qui reste.",
    glitch: "L'agitation remplace le repos. Tu peux poster 10 stories pour 3 likes et te sentir vide. Le cerveau associe 'rÃ©ussite' Ã  'vide' parce qu'il n'est jamais rassasiÃ©.",
    reboot: [
      "Demande-toi : 'Qu'est-ce que je cherche vraiment quand je performe ?' (amour, sÃ©curitÃ©, preuve d'existence)",
      "Passe 24h sans regarder tes stats, parler de tes rÃ©ussites ou comparer ton travail.",
      "Fais quelque chose juste pour toi â€” que personne ne verra jamais.",
      "Quand l'agitation monte, pose les pieds au sol et dis : 'Je suis dÃ©jÃ  lÃ .'",
      "Liste 5 choses qui te font te sentir visible sans performance."
    ]
  },
  rigueur: {
    name: "Clara",
    mode: "L'exigeante silencieuse",
    emoji: "ğŸŸ¢",
    color: "#10b981",
    img: "images/Clara.png",
    brainlag: "Tu vises l'excellence â€” pas par orgueil, mais parce que tu crois que si c'est parfait, tu seras enfin en sÃ©curitÃ©. Le problÃ¨me : parfait n'arrive jamais.",
    hypothese: "\"Si c'est parfait, je ne peux pas Ãªtre attaquÃ©(e) ou rejetÃ©(e).\"",
    protection: "Tu vÃ©rifies, tu corriges, tu recommences. Tu retiens ce qui n'est 'pas encore prÃªt'. Tu es ton propre critique le plus sÃ©vÃ¨re.",
    glitch: "La perfection devient un frein. Tu veux Ãªtre vu(e) â€” mais seulement si c'est excellent. RÃ©sultat : tu n'es souvent pas vu(e) du tout.",
    reboot: [
      "Partage quelque chose Ã  80% de 'parfait'. Observe la rÃ©action rÃ©elle.",
      "Demande-toi : 'Est-ce que je corrige pour amÃ©liorer, ou pour Ã©viter d'Ãªtre jugÃ©(e) ?'",
      "Fixe-toi une rÃ¨gle : une fois relu deux fois, c'est envoyÃ©.",
      "Remarque quand ton exigence s'applique aux autres â€” et ce que Ã§a coÃ»te Ã  la relation.",
      "Autorise-toi une chose imparfaite par jour. Intentionnellement."
    ]
  },
  sensibilite: {
    name: "Mar",
    mode: "L'Ã©ponge Ã©motionnelle",
    emoji: "ğŸ”´",
    color: "#ef4444",
    img: "images/Mar.png",
    brainlag: "Tu ressens tout â€” les tiens, ceux des autres, l'ambiance d'une piÃ¨ce. C'est un don rÃ©el. Mais quand tu absorbes tout, tu ne sais plus ce qui vient de toi et ce qui vient des autres.",
    hypothese: "\"Si je ressens tout, je ne rate rien d'important et je protÃ¨ge ceux que j'aime.\"",
    protection: "Tu captes les signaux faibles. Tu t'adaptes. Tu prends soin. Tu deviens souvent le rÃ©ceptacle Ã©motionnel du groupe.",
    glitch: "Tu te vides. Tu portes ce qui n'est pas Ã  toi. Et quand tu essaies de ne plus ressentir, tu te coupes de toi-mÃªme.",
    reboot: [
      "Avant de rÃ©agir Ã©motionnellement, demande-toi : 'Est-ce que cette Ã©motion m'appartient ?'",
      "Pratique un rituel de 'dÃ©charge' aprÃ¨s les interactions intenses (marche, douche, silence).",
      "Autorise-toi Ã  ne pas rÃ©pondre Ã  chaque signal Ã©motionnel autour de toi.",
      "Remarque ce que tu ressens quand personne ne te demande rien.",
      "CrÃ©e un espace qui n'appartient qu'Ã  toi â€” une heure, une piÃ¨ce, une activitÃ©."
    ]
  },
  puissance: {
    name: "Malik",
    mode: "Le rempart",
    emoji: "ğŸŸ ",
    color: "#f97316",
    img: "images/Malik.png",
    brainlag: "Tu avances fort. Tu tiens les autres. Tu dÃ©cides, tu protÃ¨ges, tu gardes le cap. Mais sous la force, il y a souvent une peur que tu ne montres Ã  personne : celle de ne pas Ãªtre Ã  la hauteur.",
    hypothese: "\"Si je reste fort(e), personne ne sera blessÃ© â€” et je n'aurai pas Ã  montrer mes limites.\"",
    protection: "Tu prends de la place pour que les autres n'aient pas Ã  gÃ©rer. Tu es le rempart. Tu absorbes les chocs.",
    glitch: "Tu peux confondre 'Ãªtre fort' et 'Ãªtre invulnÃ©rable'. Et l'invulnÃ©rabilitÃ© coupe la connexion avec les autres â€” et avec toi.",
    reboot: [
      "Remarque un moment oÃ¹ tu aurais pu demander de l'aide â€” et ne l'as pas fait.",
      "Observe : quand tu passes en mode 'rempart', est-ce de la force ou de la peur dÃ©guisÃ©e ?",
      "Pratique de laisser quelqu'un d'autre dÃ©cider sur une chose non-essentielle.",
      "Remarque ce que tu ressens quand tu n'as pas le contrÃ´le. Reste avec Ã§a 2 minutes.",
      "Dis Ã  quelqu'un de confiance une chose dans laquelle tu n'es pas sÃ»r(e) de toi."
    ]
  }
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   5) COMBOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

const combos = {
  "analyse-controle": {
    title: "Le/la stratÃ¨ge Ã©puisÃ©(e)",
    desc: "Tu analyses ET tu contrÃ´les. Ton cerveau ne s'arrÃªte jamais.",
    concret: "Tu prÃ©vois tout, tu comprends tout â€” et malgrÃ© Ã§a, tu ne te sens jamais vraiment en sÃ©curitÃ©.",
    glitch: "L'hypervigilance intellectuelle te coupe de l'action et du corps.",
    reboot: "Fixe une heure de 'cerveau off' quotidienne â€” sans analyser, sans planifier."
  },
  "analyse-performance": {
    title: "Le/la perfectionniste visible",
    desc: "Tu analyses pour performer encore mieux. Tu veux comprendre ET Ãªtre reconnu(e).",
    concret: "Tu prÃ©pares tout en dÃ©tail pour que le rÃ©sultat soit impressionnant.",
    glitch: "Tu peux bloquer sur l'analyse pour Ã©viter d'exposer un travail 'pas encore parfait'.",
    reboot: "Lance quelque chose avant d'Ãªtre prÃªt(e). Observe ce qui se passe vraiment."
  },
  "analyse-rigueur": {
    title: "Le/la chercheur(se) intransigeant(e)",
    desc: "Tu veux comprendre ET que ce soit juste. La prÃ©cision est ta valeur centrale.",
    concret: "Tu creuses, tu vÃ©rifies, tu recommences si ce n'est pas assez exact.",
    glitch: "Tu peux passer des heures sur un dÃ©tail qui ne change pas le rÃ©sultat global.",
    reboot: "Demande-toi : 'Quelle est la diffÃ©rence rÃ©elle entre 95% et 100% ici ?'"
  },
  "analyse-sensibilite": {
    title: "Le/la penseur(se) sensible",
    desc: "Tu ressens profondÃ©ment ET tu analyses tout ce que tu ressens.",
    concret: "Tu dÃ©cortiques tes Ã©motions au lieu de les vivre. Tu comprends beaucoup mais ressens parfois peu.",
    glitch: "L'analyse devient un bouclier contre l'Ã©motion brute.",
    reboot: "Laisse une Ã©motion traverser sans l'expliquer. Juste la vivre."
  },
  "analyse-puissance": {
    title: "Le/la stratÃ¨ge dominant(e)",
    desc: "Tu analyses pour mieux diriger. Tu comprends pour garder le dessus.",
    concret: "Tu es redoutable dans la prise de dÃ©cision â€” mais tu peux sous-estimer l'humain dans l'Ã©quation.",
    glitch: "Tu peux utiliser l'analyse pour justifier des dÃ©cisions dÃ©jÃ  prises.",
    reboot: "Demande l'avis de quelqu'un avant d'avoir formÃ© ta propre opinion."
  },
  "controle-performance": {
    title: "La machine organisÃ©e",
    desc: "Tu planifies ET tu produis. Tu es souvent celui ou celle qui fait tourner les choses.",
    concret: "Tu crÃ©es des systÃ¨mes efficaces pour performer. Tu es fiable, rigoureux(se), constant(e).",
    glitch: "Tu peux devenir esclave de ton propre systÃ¨me. La flexibilitÃ© disparaÃ®t.",
    reboot: "Sabote volontairement un planning â€” et observe que rien ne s'effondre."
  },
  "controle-rigueur": {
    title: "L'architecte du dÃ©tail",
    desc: "Tu contrÃ´les ET tu exiges la perfection. Rien n'Ã©chappe Ã  ton regard.",
    concret: "Tu es celui ou celle Ã  qui on confie les projets complexes. Tu livres â€” toujours.",
    glitch: "L'exigence envers les autres peut crÃ©er des tensions et de l'isolement.",
    reboot: "Laisse quelqu'un livrer quelque chose d'imparfait sans intervenir."
  },
  "controle-sensibilite": {
    title: "Le/la gardien(ne) Ã©motionnel(le)",
    desc: "Tu anticipes les risques ET tu ressens les Ã©motions du groupe.",
    concret: "Tu veilles sur les autres â€” souvent avant mÃªme qu'ils sachent qu'ils ont besoin d'aide.",
    glitch: "Tu portes les Ã©motions des autres comme des donnÃ©es Ã  gÃ©rer.",
    reboot: "Laisse quelqu'un traverser une difficultÃ© sans intervenir. Observe."
  },
  "controle-puissance": {
    title: "Le leader blindÃ©",
    desc: "Tu contrÃ´les ET tu imposes. Tu es le pilier â€” mais parfois le mur.",
    concret: "Tu stabilises les situations de crise. Les autres te font confiance instinctivement.",
    glitch: "Tu peux confondre sÃ©curitÃ© et domination. La connexion en pÃ¢tit.",
    reboot: "Partage une incertitude avec ton Ã©quipe ou tes proches."
  },
  "performance-rigueur": {
    title: "L'excellence sous pression",
    desc: "Tu veux performer ET que ce soit parfait. Une combinaison puissante â€” et Ã©puisante.",
    concret: "Tu peux retarder des projets parce qu'ils ne sont 'pas encore prÃªts'.",
    glitch: "La perfection devient un frein Ã  la performance. Tu veux Ãªtre vu(e) â€” mais seulement si c'est excellent.",
    reboot: "Partage quelque chose Ã  80% de 'parfait'. Observe la rÃ©action rÃ©elle."
  },
  "performance-sensibilite": {
    title: "L'artiste en scÃ¨ne",
    desc: "Tu ressens profondÃ©ment ET tu as besoin d'Ãªtre vu(e).",
    concret: "Ton travail est chargÃ© de sens et d'Ã©motion. Tu peux Ãªtre trÃ¨s crÃ©atif(ve) â€” mais aussi trÃ¨s fragile face au regard des autres.",
    glitch: "Tu exposes ton monde intÃ©rieur Ã  travers ta performance â€” et la moindre critique touche directement qui tu es.",
    reboot: "CrÃ©e quelque chose juste pour toi, que personne ne verra. Observe la libertÃ© que Ã§a procure."
  },
  "performance-puissance": {
    title: "Le leader visible",
    desc: "Tu performes ET tu imposes. Tu veux Ãªtre vu(e) comme fort(e) et compÃ©tent(e).",
    concret: "Tu prends de la place naturellement. Tu avances, tu dÃ©cides, tu montres.",
    glitch: "Tu peux confondre 'Ãªtre fort' et 'Ãªtre invulnÃ©rable'. L'invulnÃ©rabilitÃ© coupe la connexion.",
    reboot: "Partage une difficultÃ© rÃ©elle avec quelqu'un. Observe que la force ne disparaÃ®t pas quand tu montres une limite."
  },
  "rigueur-sensibilite": {
    title: "L'empathique exigeant",
    desc: "Tu ressens les autres profondÃ©ment ET tu t'exiges beaucoup.",
    concret: "Tu peux Ãªtre dur(e) envers toi-mÃªme tout en prenant soin des autres avec douceur.",
    glitch: "Tu appliques deux poids deux mesures â€” indulgent(e) avec les autres, impitoyable avec toi.",
    reboot: "Parle-toi comme tu parlerais Ã  quelqu'un que tu aimes."
  },
  "rigueur-puissance": {
    title: "Le juge intÃ©rieur",
    desc: "Tu t'exiges ET tu imposes. Ton standard est Ã©levÃ© â€” pour toi et pour les autres.",
    concret: "Tu Ã©lÃ¨ves le niveau partout oÃ¹ tu passes. Mais tu peux Ã©puiser ceux qui t'entourent.",
    glitch: "Tu peux percevoir comme faiblesse ce qui est en rÃ©alitÃ© de l'humanitÃ©.",
    reboot: "CÃ©lÃ¨bre un effort â€” pas un rÃ©sultat. Le tien ou celui de quelqu'un d'autre."
  },
  "sensibilite-puissance": {
    title: "Le/la volcanique",
    desc: "Tu ressens intensÃ©ment ET tu rÃ©agis fort. Tes Ã©motions ont du poids et de l'impact.",
    concret: "Tu peux Ãªtre profondÃ©ment touchant(e) et inspirant(e) â€” ou dÃ©vastateur(trice) sans le vouloir.",
    glitch: "L'intensitÃ© Ã©motionnelle peut prendre la forme de la force â€” et blesser.",
    reboot: "Avant d'agir sous une Ã©motion forte, attends 10 minutes. Puis dÃ©cide."
  }
};

// Nuances â€œshadowâ€ Ã  injecter dans les combos si significatif
const comboShadowNuances = {
  enthousiasme: "Nuance : tu peux chercher Ã  relancer / accÃ©lÃ©rer pour ne pas rester dans lâ€™inconfort. Le vrai reboot, ici, câ€™est de tolÃ©rer un peu de lenteur sans perdre ta flamme.",
  harmonie: "Nuance : tu peux lisser, tâ€™adapter, Ã©viter le conflit â€” mÃªme quand tu aurais besoin de dire non. Le reboot : tester une micro-friction saine, sans te justifier.",
  relation: "Nuance : tu peux porter Ã©motionnellement les autres ou te rendre indispensable. Le reboot : tâ€™autoriser Ã  exister sans aider, sans rÃ©parer."
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   6) RENDU DU QUIZ (shuffle stable session)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function renderQuiz() {
  const container = document.getElementById('questionsContainer');
  container.innerHTML = '';

  // MÃ©lange questions 1 seule fois par session
  if (shuffledQuestions.length === 0) {
    shuffledQuestions = shuffleArray(questions);
  }

  shuffledQuestions.forEach((q, i) => {
    const block = document.createElement('div');
    block.className = 'question-block';
    block.innerHTML = `
      <p class="question-number">Question ${i + 1} / ${TOTAL_Q}</p>
      <p class="question-text">${q.text}</p>
      <div class="options" id="opts-${i}"></div>
    `;
    container.appendChild(block);

    const optsDiv = block.querySelector(`#opts-${i}`);

    // MÃ©lange rÃ©ponses 1 seule fois par question (stable session)
    if (!q.shuffledOptions) {
      q.shuffledOptions = shuffleArray(q.options);
    }

    q.shuffledOptions.forEach(opt => {
      const btn = document.createElement('button');
      btn.className = 'option-btn';
      btn.textContent = opt.label;
      btn.onclick = () => selectOption(i, opt, btn, optsDiv);
      optsDiv.appendChild(btn);
    });
  });

  updateProgress();
}

function selectOption(qIndex, opt, btn, optsDiv) {
  optsDiv.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');

  // On stocke lâ€™objet complet
  answers[qIndex] = opt;

  updateProgress();
  checkSubmit();
}

function updateProgress() {
  const answered = Object.keys(answers).length;
  const pct = (answered / TOTAL_Q) * 100;
  document.getElementById('progressFill').style.width = pct + '%';
}

function checkSubmit() {
  const answered = Object.keys(answers).length;
  document.getElementById('submitBtn').disabled = answered < TOTAL_Q;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   7) RÃ‰SULTATS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function showResults() {
  if (Object.keys(answers).length < TOTAL_Q) {
    const err = document.getElementById('errorMsg');
    err.style.display = 'block';
    return;
  }

  const scores = { analyse: 0, controle: 0, performance: 0, rigueur: 0, sensibilite: 0, puissance: 0 };
  shadowScores = { enthousiasme: 0, harmonie: 0, relation: 0 };

  Object.values(answers).forEach(opt => {
    scores[opt.profile]++;
    if (opt.shadow) shadowScores[opt.shadow]++;
  });

  const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
  const [key1, score1] = sorted[0];
  const [key2, score2] = sorted[1];
  const total = TOTAL_Q;

  const p1 = profiles[key1];
  const p2 = profiles[key2];

  const comboKey = [key1, key2].sort().join('-');
  const mix = (score2 >= 3 && combos[comboKey]) ? combos[comboKey] : null;

  const shadow = computeShadow(); // null ou { key,val,text }
  const shadowNuanceForCombo = (shadow && mix) ? comboShadowNuances[shadow.key] : null;

  let html = `
    <p class="section-content" style="color:#aaa; font-size:0.9rem; line-height:1.6; margin-bottom:24px;">
      Dans Brainlag, on parle parfois de â€œbugâ€.<br>
      Pas parce que quelque chose ne va pas,<br>
      mais parce que ton systÃ¨me se dÃ©clenche tout seul.
    </p>

    <span class="tag tag-dominant">ğŸ§¬ Ton brainlag dominant</span>
  `;

  html += `
    <div class="profile-card" style="border-color: ${p1.color}22;">
      <div class="profile-header">
        <img
          src="${p1.img}"
          alt="${p1.name}"
          class="profile-avatar"
          style="border-color: ${p1.color};"
          onerror="this.style.display='none'"
        >
        <div>
          <div class="profile-title" style="color:${p1.color}">${p1.emoji} ${p1.name}</div>
          <div class="profile-subtitle">${p1.mode}</div>
        </div>
      </div>

      <p class="section-label">Le brainlag</p>
      <p class="section-content">${p1.brainlag}</p>

      <p class="section-label">L'hypothÃ¨se cachÃ©e</p>
      <p class="section-content" style="font-style:italic; color:#aaa">${p1.hypothese}</p>

      <p class="section-label">Comment tu te protÃ¨ges</p>
      <p class="section-content">${p1.protection}</p>

      <p class="section-label">âš ï¸ Le glitch</p>
      <p class="section-content">${p1.glitch}</p>

   <p class="section-label">ğŸ”§ PremiÃ¨re bascule</p>
<ul class="steps">
  ${p1.reboot.slice(0,2).map(r => `<li>${r}</li>`).join('')}
</ul>

<p class="section-label">ğŸ§  Ã€ observer cette semaine</p>
<ul class="steps">
  ${p1.reboot.slice(2).map(r => `<li>${r}</li>`).join('')}
</ul>

<p class="section-content" style="margin-top:14px; color:#aaa; font-size:0.85rem;">
  Le protocole complet de transformation est disponible dans le Guide Reboot.
</p>

    <hr class="divider">
  `;

  if (score2 >= 2) {
    html += `
      <span class="tag tag-secondary">ğŸŒ€ Ton mode secondaire</span>
      <div class="profile-card" style="border-color: ${p2.color}22; opacity: 0.85;">
        <div class="profile-header">
          <img
            src="${p2.img}"
            alt="${p2.name}"
            class="profile-avatar"
            style="border-color: ${p2.color}; width:64px; height:64px;"
            onerror="this.style.display='none'"
          >
          <div>
            <div class="profile-title" style="color:${p2.color}; font-size:1.2rem">${p2.emoji} ${p2.name}</div>
            <div class="profile-subtitle">${p2.mode}</div>
          </div>
        </div>
        <p class="section-content">${p2.brainlag}</p>
      </div>
      <hr class="divider">
    `;
  }

  if (mix) {
    html += `
      <span class="tag tag-mix">ğŸ§¬ Ton combo unique</span>
      <div class="mix-card">
        <div class="profile-title" style="font-size:1.3rem">${mix.title}</div>

        <p class="section-label" style="margin-top:16px">Ce que Ã§a crÃ©e</p>
        <p class="section-content">${mix.desc}</p>

        <p class="section-label">ConcrÃ¨tement</p>
        <p class="section-content">${mix.concret}</p>

        <p class="section-label">âš ï¸ Le glitch combinÃ©</p>
        <p class="section-content">${mix.glitch}</p>

        <p class="section-label">ğŸ”§ Par oÃ¹ commencer</p>
        <p class="section-content">${mix.reboot}</p>

        ${shadowNuanceForCombo ? `
          <p class="section-label">ğŸ§© Nuance (dynamique transversale)</p>
          <p class="section-content" style="color:#cfcfcf">${shadowNuanceForCombo}</p>
        ` : ''}
      </div>
      <hr class="divider">
    `;
  }

  // Tableau des scores
  html += `
    <p class="section-label">ğŸ“Š Ton tableau de bord</p>
    ${Object.entries(scores).sort((a, b) => b[1] - a[1]).map(([key, val]) => `
      <div class="score-bar-wrap">
        <div class="score-bar-label">
          <span>${profiles[key].emoji} ${profiles[key].name}</span>
          <span>${val} / ${total}</span>
        </div>
        <div class="score-bar">
          <div class="score-bar-fill" style="width:${(val / total) * 100}%; background:${profiles[key].color}"></div>
        </div>
      </div>
    `).join('')}
  `;

// Paragraphe discret shadow (si significatif)
if (shadow) {
  html += `
    <hr class="divider">
    <p class="section-label">ğŸ” Dynamique secondaire</p>
    <p class="section-content">
      Ton systÃ¨me montre aussi ${shadow.text}.
    </p>
  `;
}

// Mini dynamiques 7 / 9 / 2 (toujours visibles, en discret)
html += `
  <div style="margin-top:28px;">
    <p style="
      font-size:0.75rem;
      letter-spacing:2px;
      text-transform:uppercase;
      color:#888;
      margin-bottom:14px;
    ">
      Dynamiques transversales
    </p>

    ${[
      { key: "enthousiasme", label: "âœ¨ Enthousiasme", color: "#fbbf24" },
      { key: "harmonie", label: "âš–ï¸ Harmonie", color: "#60a5fa" },
      { key: "relation", label: "ğŸ¤ Relation", color: "#f472b6" }
    ].map(d => `
      <div style="margin-bottom:14px;">
        <div style="
          display:flex;
          justify-content:space-between;
          font-size:0.85rem;
          color:#ccc;
          margin-bottom:6px;
        ">
          <span>${d.label}</span>
          <span style="color:#999;">${shadowScores[d.key]}</span>
        </div>
        <div style="
          height:6px;
          background:#1f1f1f;
          border-radius:3px;
        ">
          <div style="
            height:100%;
            width:${(shadowScores[d.key] / TOTAL_Q) * 100}%;
            background:${d.color};
            border-radius:3px;
            transition:width 0.6s ease;
          "></div>
        </div>
      </div>
    `).join('')}
  </div>

`;
  html += `
    <hr class="divider">

    <div class="action-buttons">
      <button class="btn-action btn-share" onclick="shareResult('${p1.name}', '${mix ? mix.title : p1.mode}')">
        â†— Partager mon rÃ©sultat
      </button>
      <a class="btn-action btn-instagram" href="https://www.instagram.com/klea.brainlag/" target="_blank">
        â†’ Rejoindre @klea.brainlag
      </a>
      <button class="btn-action btn-restart" onclick="showEndScreen()">
        â†’ Terminer
      </button>
    </div>
  `;

  document.getElementById('quizSection').style.display = 'none';
  const resultSection = document.getElementById('resultSection');
  resultSection.style.display = 'block';
  resultSection.innerHTML = html;
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   8) END SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function showEndScreen() {
  document.getElementById('resultSection').style.display = 'none';
  document.getElementById('endScreen').style.display = 'block';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   9) UTILITAIRES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function shareResult(name, combo) {
  const text =
`Mon Brainlag dominant : ${name}
${combo ? "Mon mode secondaire / combo : " + combo : ""}
DÃ©couvre le tien â†’ https://klea-brainlag.github.io/Brainlag-Quiz/`;

  if (navigator.share) {
    navigator.share({ title: "Mon Brainlag", text: text });
  } else {
    navigator.clipboard.writeText(text);
    alert("RÃ©sultat copiÃ©. Tu peux le partager.");
  }
}

function shareQuiz() {
  const text = "DÃ©couvre ton Brainlag â†’ https://klea-brainlag.github.io/Brainlag-Quiz/";

  if (navigator.share) {
    navigator.share({
      title: "Ton Brainlag",
      text: text,
      url: "https://klea-brainlag.github.io/Brainlag-Quiz/"
    });
  } else {
    navigator.clipboard.writeText("https://klea-brainlag.github.io/Brainlag-Quiz/");
    alert("Lien du quiz copiÃ©.");
  }
}

function restartQuiz() {
  Object.keys(answers).forEach(k => delete answers[k]);

  // Reset shuffle session
  shuffledQuestions = [];
  questions.forEach(q => { delete q.shuffledOptions; });

  document.getElementById('endScreen').style.display = 'none';
  document.getElementById('resultSection').style.display = 'none';
  document.getElementById('quizSection').style.display = 'block';
  document.getElementById('progressFill').style.width = '0%';

  renderQuiz();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   10) INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

renderQuiz();
</script>
</body>
</html>
